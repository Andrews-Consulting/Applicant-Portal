<aura:component implements="forceCommunity:availableForAllPageTypes" controller="dx_OwnerAccountSearch" access="global">

    <aura:attribute name="owner" type="object" />
    <aura:attribute name="accounts" type="Account[]" />
    <aura:attribute name="accountId" type="Id" />
    <aura:attribute name="showError" type="Boolean" required="true" description="" default="false" access="private" />
    <aura:attribute name="showSearch" type="Boolean" required="true" description="" default="true" access="private" />
    <aura:attribute name="errorMessage" type="String" required="false" description="" access="private" />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />

    <div>
        <aura:renderIf isTrue="{!v.showError}">
            <div aura:id="error" class="slds-container--center slds-container--small" id="error">
                <ui:outputRichText value="{!v.errorMessage}" />
            </div>
        </aura:renderIf>
        <aura:if isTrue="{!and(v.owner, v.accounts.length==0)}">
            <div id="slds-form-element slds-is-required" class="slds-container--center slds-container--small">
                <lightning:input value="{!v.owner.firstName}" aura:id="fName" required="true" label="Owner's First Name" />
            </div>
            <div id="slds-form-element slds-is-required" class="slds-container--center slds-container--small">
                <lightning:input value="{!v.owner.lastName}" aura:id="lName" required="true" label="Owner's Last Name" />
            </div>
            <div id="slds-form-element slds-is-required" class="slds-container--center slds-container--small">
                <lightning:input value="{!v.owner.ssn}" aura:id="ssn" required="true" label="Owner's Social Security Number" placeholder="123-45-6789" pattern="[0-9]{3}-[0-9]{2}-[0-9]{4}" />
            </div>

            <div class="slds-container--center slds-container--small inner">
                <p>&nbsp;</p>
                <ui:button aura:id="submitButton" label="Find Existing Licenses" press="{!c.findAccounts}"  class="stdButton" />
                <div class="slds-spinner_container slds-is-fixed slds-hide" aura:id="spinner">
                    <lightning:spinner variant="brand" size="large" alternativeText="spinner" />
                </div>
            </div>
        </aura:if>
        <aura:if isTrue="{!v.accounts.length>0}">

            <table class="slds-table slds-table--bordered slds-table--cell-buffer" style="width:50vw;">
                <thead>
                    <tr class="slds-text-title--caps">
                        <th scope="col">
                            <div class="slds-truncate" title="Name">Name</div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <aura:iteration items="{!v.accounts}" var="acc">
                        <tr>
                            <th scope="row" data-label="Application Name" style="width:25vw">
                                <ui:outputURL value="" click="{!c.navigateToAccount}" class="{!acc.Id}" label="{!acc.Name}" />
                            </th>
                        </tr>
                    </aura:iteration>
                </tbody>
            </table>

            <div class="sfdc">
                <p>&nbsp;</p>
                <ui:button aura:id="submitButton" label="New Search" press="{!c.resetAccounts}" class="sfdc_button" />
                <div class="slds-spinner_container slds-is-fixed slds-hide" aura:id="spinner">
                    <lightning:spinner variant="brand" size="large" alternativeText="spinner" />
                </div>
            </div>
        </aura:if>
        <aura:renderIf isTrue="{!v.showError}">
            <div class="slds-container--center slds-container--small inner">
                <h2>If you are unable to connect with an existing license at this time, you can reconnect at a later time through the following steps:</h2><br/>
				<p style="font-weight: bold">1. Log on as an existing user (with the information entered on the "Register New User" page).<br/>
											2. Select My Account, and select Connect my User to another company with licenses/permits.</p>
        	</div>
        </aura:renderIf>

    </div>
</aura:component>